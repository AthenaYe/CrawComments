1. check boundaries
2. add multithread
